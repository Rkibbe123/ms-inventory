# v7.34 Quick Verification Checklist

## üö¶ BEFORE TESTING
```powershell
# 1. Verify container shows v7.34 image
az containerapp show --name azure-resource-inventory --resource-group rg-rkibbe-2470 --query "properties.template.containers[0].image" -o tsv
# Expected: rkazureinventory.azurecr.io/azure-resource-inventory:v7.34
```

## üîç DURING EXECUTION - Watch for These Lines:

### ‚úÖ SUCCESS INDICATORS (must see ALL):
```
Line ~64:  üí° Using per-job filtering to reduce memory footprint
Line ~200: ‚öôÔ∏è  Parallel job limit set to 4
Line ~105: üì¶ [AI] Filtered to XX resources
Line ~108: DEBUG: Job temp file: X.XX MB for XX resources  (repeated 16 times)
Line ~236: Get-Job returned: 8 jobs  (or similar, NOT 0)
Line ~XXX: Cache Files Created: 16 files  (NOT 0)
```

### ‚ùå FAILURE INDICATORS (must NOT see ANY):
```
‚ùå Line ~200: Parallel job limit set to 8
‚ùå Line ~204: Converting Resource data to JSON for Jobs
‚ùå Line ~207: Temp file created: 17.53 MB
‚ùå Line ~245: Reading resources from temp file: /tmp/ari_resources_XXXXXX.json
‚ùå Line ~247: Deserializing JSON...
‚ùå Line ~236: Get-Job returned: 0 jobs
‚ùå Line ~XXX: Cache Files Created: 0 files
```

## üéØ AFTER EXECUTION - Check Reports:

### Excel File Should Have These Tabs:
- [ ] AI (Cognitive Services, OpenAI)
- [ ] Analytics (Synapse, Data Factory)
- [ ] APIs (API Management)
- [ ] Compute (VMs, App Services)
- [ ] Container (AKS, Container Apps)
- [ ] Database (SQL, Cosmos, MySQL)
- [ ] Hybrid (Arc)
- [ ] Integration (Logic Apps, Service Bus)
- [ ] Management
- [ ] Monitoring (Log Analytics)
- [ ] Networking (VNets, NSGs, Load Balancers)
- [ ] Security (Key Vault)
- [ ] Storage (Storage Accounts, Disks)
- [ ] Web
- [ ] Advisor
- [ ] Subscriptions

### ‚ùå If Report Only Has These Tabs = FAILED:
- Only Advisor (duplicate rows)
- Only Subscriptions
- Missing most resource types

## üîß IF v7.34 NOT RUNNING YET:

### Option 1: Wait (5-10 minutes)
Container may auto-restart and pull v7.34 image.

### Option 2: Force Restart via Portal
1. Go to Azure Portal
2. Navigate to Container App: `azure-resource-inventory`
3. Click "Restart" on revision `0000102`

### Option 3: Create New Revision
```powershell
az containerapp update --name azure-resource-inventory --resource-group rg-rkibbe-2470 --set-env-vars "DEPLOYMENT_VERSION=v7.34"
```

### Option 4: Last Resort - Scale Cycle
```powershell
# Scale to 0
az containerapp update --name azure-resource-inventory --resource-group rg-rkibbe-2470 --min-replicas 0 --max-replicas 0

# Wait 30 seconds

# Scale back to 1
az containerapp update --name azure-resource-inventory --resource-group rg-rkibbe-2470 --min-replicas 1 --max-replicas 10
```

## üìä EXPECTED PERFORMANCE:

### v7.34 (New - Per-Job Filtering):
- **Concurrent Jobs**: 4
- **Temp Files**: 16 files √ó 5-10 MB = 80-160 MB total
- **Memory Per Job**: ~10 MB
- **Total Memory**: 4 √ó 10 MB = 40 MB
- **Cache Files**: 16 files (one per module)
- **Excel Tabs**: All 16 resource types

### v7.32/v7.33 (Old - Global Serialization):
- **Concurrent Jobs**: 8
- **Temp Files**: 1 file √ó 17-87 MB = 17-87 MB
- **Memory Per Job**: ~87 MB
- **Total Memory**: 8 √ó 87 MB = 696 MB
- **Cache Files**: 0 (jobs crash before creating files)
- **Excel Tabs**: Only Advisor (duplicate rows)

## üéâ SUCCESS CONFIRMATION:

When you see ALL of these:
```
‚úÖ "Parallel job limit set to 4"
‚úÖ "Using per-job filtering"
‚úÖ "Filtered to XX resources" (16 times)
‚úÖ "Get-Job returned: 8 jobs" (or similar, NOT 0)
‚úÖ "Cache Files Created: 16 files"
‚úÖ Excel report with all 16 resource type tabs
‚úÖ No "Deserializing JSON..." errors
‚úÖ No NULL job results
```

**Then v7.34 is working correctly! üéä**

---

## üìû QUICK COMMANDS:

```powershell
# Check current image
az containerapp show --name azure-resource-inventory --resource-group rg-rkibbe-2470 --query "properties.template.containers[0].image" -o tsv

# Check active revision
az containerapp revision list --name azure-resource-inventory --resource-group rg-rkibbe-2470 --query "[?properties.active].{Name:name,Image:properties.template.containers[0].image}" -o table

# View live logs
az containerapp logs show --name azure-resource-inventory --resource-group rg-rkibbe-2470 --follow

# Restart container
az containerapp revision restart --name azure-resource-inventory --resource-group rg-rkibbe-2470 --revision azure-resource-inventory--0000102
```
